# Android 摄像头流传输应用

## 功能说明

这是一个Android应用，可以将手机摄像头视频流通过TCP/IP传输到PC端。

### 主要功能

1. **摄像头预览** - 实时显示手机摄像头画面
2. **TCP/IP传输** - 通过TCP协议将视频流发送到PC
3. **降采样** - 自动将视频降采样到640x480以节省带宽
4. **摄像头类型选择** - 可以选择作为俯视摄像头(CAM_HIGH)或左视摄像头(CAM_LEFT_WRIST)
5. **帧率控制** - 限制传输帧率为30fps

## 使用方法

### 1. 配置PC端

确保PC端运行 `main.py`，它会自动启动TCP服务器监听8888端口。

### 2. 获取PC的IP地址

在PC上运行以下命令获取IP地址：
- Windows: `ipconfig`
- Linux/Mac: `ifconfig` 或 `ip addr`

### 3. 在Android应用中

1. 打开应用
2. 授予摄像头权限
3. 输入PC的IP地址（例如：192.168.1.100）
4. 选择摄像头类型：
   - **CAM_HIGH** - 俯视全局摄像头（对应PC端的camera_id=0）
   - **CAM_LEFT_WRIST** - 左视图摄像头（对应PC端的camera_id=1）
5. 点击"开始连接"按钮
6. 连接成功后，视频流会自动传输到PC端

## 技术细节

### 协议格式

1. 连接建立后，客户端首先发送1字节的摄像头ID（0或1）
2. 之后每帧数据格式：
   - 4字节（大端序）：图像数据大小
   - N字节：JPEG压缩的图像数据

### 性能优化

- 图像降采样到640x480
- JPEG压缩质量80%
- 帧率限制为30fps
- 使用协程异步处理，避免阻塞UI

## 依赖项

- CameraX - 摄像头访问
- Kotlin Coroutines - 异步处理
- Accompanist Permissions - 权限处理
- Jetpack Compose - UI框架

## 注意事项

1. 确保手机和PC在同一局域网内
2. 确保PC防火墙允许8888端口的连接
3. 如果连接失败，检查IP地址是否正确
4. 建议使用WiFi连接以获得更好的性能
